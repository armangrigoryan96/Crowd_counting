See implementations in https://colab.research.google.com/drive/13QNQvyZZwsh7XXTCSZIRzMO3ggwUydL7?usp=sharing
